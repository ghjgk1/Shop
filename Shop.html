<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        body {
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        header {
            background-color: #4285f4;
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
        }
        nav a {
            color: white;
            text-decoration: none;
            margin-left: 1rem;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        .auth-buttons button, .auth-buttons span {
            margin-left: 0.5rem;
        }
        .login-btn {
            background-color: white;
            color: #4285f4;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .register-btn, .logout-btn {
            background-color: #3367d6;
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .search-filter {
            display: flex;
            margin: 1rem 0;
            gap: 1rem;
        }
        .search-filter input, .search-filter select {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .search-filter input {
            flex-grow: 1;
        }
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }
        .product-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: relative;
            transition: transform 0.3s;
        }
        .product-card:hover {
            transform: translateY(-5px);
        }
        .product-image {
            height: 200px;
            background-color: #eee;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            background-size: cover;
            background-position: center;
        }
        .product-content {
            padding: 1rem;
        }
        .product-title {
            font-size: 1.2rem;
            margin: 0 0 0.5rem 0;
        }
        .product-price {
            font-weight: bold;
            color: #4285f4;
            margin: 0.5rem 0;
        }
        .product-category {
            display: inline-block;
            background-color: #e8f0fe;
            color: #3367d6;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        .product-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
        }
        .product-actions button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .buy-btn {
            background-color: #4285f4;
            color: white;
            flex-grow: 1;
        }
        .cart-btn {
            background-color: #34a853;
            color: white;
            margin-left: 0.5rem;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 8px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal h2 {
            margin-top: 0;
        }
        .form-group {
            margin-bottom: 1rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
        }
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        .form-actions button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .cancel-btn {
            background-color: #f5f5f5;
        }
        .save-btn {
            background-color: #4285f4;
            color: white;
        }
        .admin-panel {
            background-color: #fbbc05;
            padding: 0.5rem;
            margin-bottom: 1rem;
            border-radius: 4px;
            display: none;
        }
        .cart-icon {
            position: relative;
            margin-left: 1rem;
            cursor: pointer;
        }
        .cart-count {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: #ea4335;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
        }
        .error-message {
            color: #ea4335;
            font-size: 0.8rem;
            margin-top: 0.2rem;
        }
        .hidden {
            display: none;
        }
        .tab-buttons {
            display: flex;
            margin-bottom: 1rem;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            background-color: #e0e0e0;
            border: none;
            cursor: pointer;
            flex: 1;
            text-align: center;
        }
        .tab-button.active {
            background-color: #4285f4;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .image-preview {
            max-width: 100%;
            max-height: 150px;
            margin-top: 0.5rem;
            display: none;
        }
        .cart-modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 8px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #eee;
        }
        .cart-item img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            margin-right: 1rem;
        }
        .cart-item-info {
            flex-grow: 1;
        }
        .cart-item-actions {
            display: flex;
            align-items: center;
        }
        .cart-item-actions button {
            padding: 0.3rem 0.6rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 0.5rem;
        }
        .quantity-control {
            display: flex;
            align-items: center;
        }
        .quantity-control button {
            background-color: #f5f5f5;
        }
        .quantity-control input {
            width: 40px;
            text-align: center;
            margin: 0 0.5rem;
        }
        .cart-total {
            font-weight: bold;
            font-size: 1.2rem;
            text-align: right;
            margin-top: 1rem;
        }
        .checkout-btn {
            background-color: #4285f4;
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 1rem;
            width: 100%;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω</div>
        <nav>
            <a href="#" id="homeLink">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="#" id="productsLink">–¢–æ–≤–∞—Ä—ã</a>
            <a href="#">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a>
            <a href="#">–û –Ω–∞—Å</a>
        </nav>
        <div class="auth-buttons">
            <span id="userGreeting" class="hidden">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span id="userName"></span></span>
            <button id="loginBtn" class="login-btn">–í–æ–π—Ç–∏</button>
            <button id="registerBtn" class="register-btn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            <button id="logoutBtn" class="logout-btn hidden">–í—ã–π—Ç–∏</button>
            <div class="cart-icon" id="cartIcon">
                üõí
                <span class="cart-count hidden" id="cartCount">0</span>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="admin-panel" id="adminPanel">
            <strong>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</strong>
            <a href="#" id="manageProductsLink">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</a> |
            <a href="#" id="manageCategoriesLink">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</a> |
            <a href="#" id="manageOrdersLink">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</a>
        </div>

        <div class="search-filter">
            <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...">
            <select id="categoryFilter">
                <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                <option value="office">–û—Ñ–∏—Å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</option>
                <option value="home">–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–æ–º–∞</option>
                <option value="kitchen">–ö—É—Ö–æ–Ω–Ω—ã–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏</option>
                <option value="stationery">–ö–∞–Ω—Ü–µ–ª—è—Ä–∏—è</option>
            </select>
            <button id="applyFilterBtn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        </div>

        <button id="addProductBtn" class="create-ad-btn hidden">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>

        <div class="products-grid" id="productsGrid">
            <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ —á–µ—Ä–µ–∑ JavaScript -->
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—Ö–æ–¥–∞ -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            <div class="form-group">
                <label for="loginEmail">Email</label>
                <input type="email" id="loginEmail" required>
                <div id="loginEmailError" class="error-message"></div>
            </div>
            <div class="form-group">
                <label for="loginPassword">–ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="loginPassword" required>
                <div id="loginPasswordError" class="error-message"></div>
            </div>
            <div class="form-actions">
                <button class="cancel-btn" id="cancelLoginBtn">–û—Ç–º–µ–Ω–∞</button>
                <button class="save-btn" id="confirmLoginBtn">–í–æ–π—Ç–∏</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <div class="form-group">
                <label for="regName">–ò–º—è</label>
                <input type="text" id="regName" required>
                <div id="regNameError" class="error-message"></div>
            </div>
            <div class="form-group">
                <label for="regEmail">Email</label>
                <input type="email" id="regEmail" required>
                <div id="regEmailError" class="error-message"></div>
            </div>
            <div class="form-group">
                <label for="regPassword">–ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="regPassword" required>
                <div id="regPasswordError" class="error-message"></div>
            </div>
            <div class="form-group">
                <label for="regConfirmPassword">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                <input type="password" id="regConfirmPassword" required>
                <div id="regConfirmPasswordError" class="error-message"></div>
            </div>
            <div class="form-group" id="roleField">
                <label for="regRole">–†–æ–ª—å</label>
                <select id="regRole">
                    <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                    <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                </select>
            </div>
            <div class="form-actions">
                <button class="cancel-btn" id="cancelRegisterBtn">–û—Ç–º–µ–Ω–∞</button>
                <button class="save-btn" id="confirmRegisterBtn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <h2 id="productModalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h2>
            <div class="form-group">
                <label for="productTitle">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
                <input type="text" id="productTitle" required>
                <div id="productTitleError" class="error-message"></div>
            </div>
            <div class="form-group">
                <label for="productDescription">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                <textarea id="productDescription" rows="4" required></textarea>
                <div id="productDescriptionError" class="error-message"></div>
            </div>
            <div class="form-group">
                <label for="productPrice">–¶–µ–Ω–∞ *</label>
                <input type="number" id="productPrice" required>
                <div id="productPriceError" class="error-message"></div>
            </div>
            <div class="form-group">
                <label for="productCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                <select id="productCategory" required>
                    <option value="office">–û—Ñ–∏—Å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</option>
                    <option value="home">–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–æ–º–∞</option>
                    <option value="kitchen">–ö—É—Ö–æ–Ω–Ω—ã–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏</option>
                    <option value="stationery">–ö–∞–Ω—Ü–µ–ª—è—Ä–∏—è</option>
                </select>
            </div>
            <div class="form-group">
                <label for="productStock">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ *</label>
                <input type="number" id="productStock" required>
                <div id="productStockError" class="error-message"></div>
            </div>
            
            <div class="tab-buttons">
                <button class="tab-button active" data-tab="urlTab">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</button>
                <button class="tab-button" data-tab="uploadTab">–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞</button>
            </div>
            
            <div id="urlTab" class="tab-content active">
                <div class="form-group">
                    <label for="imageUrl">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                    <input type="text" id="imageUrl" placeholder="https://example.com/image.jpg">
                    <button id="previewImageBtn">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å</button>
                </div>
                <img id="urlImagePreview" class="image-preview" alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
            </div>
            
            <div id="uploadTab" class="tab-content">
                <div class="form-group">
                    <label for="productImage">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
                    <input type="file" id="productImage" accept="image/*">
                    <img id="uploadImagePreview" class="image-preview" alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
                </div>
            </div>
            
            <div class="form-actions">
                <button class="cancel-btn" id="cancelProductBtn">–û—Ç–º–µ–Ω–∞</button>
                <button class="save-btn" id="saveProductBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ—Ä–∑–∏–Ω—ã -->
    <div class="modal" id="cartModal">
        <div class="cart-modal-content">
            <h2>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h2>
            <div id="cartItemsContainer">
                <!-- –¢–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
            </div>
            <div class="cart-total">
                –ò—Ç–æ–≥–æ: <span id="cartTotal">0</span> —Ä—É–±.
            </div>
            <button class="checkout-btn" id="checkoutBtn">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
        </div>
    </div>

    <script>
        // –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å localStorage
        class StorageService {
            static get(key) {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            }

            static set(key, value) {
                localStorage.setItem(key, JSON.stringify(value));
            }

            static remove(key) {
                localStorage.removeItem(key);
            }
        }

        // –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–≤–∞—Ä–∞–º–∏
        class ProductService {
            static KEY = 'products';
            static CART_KEY = 'cart';

            static getAll() {
                return StorageService.get(this.KEY) || [];
            }

            static getById(id) {
                const products = this.getAll();
                return products.find(product => product.id === id);
            }

            static create(product) {
                const products = this.getAll();
                const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
                const newProduct = { 
                    ...product, 
                    id: newId
                };
                products.push(newProduct);
                StorageService.set(this.KEY, products);
                return newProduct;
            }

            static update(id, updatedProduct) {
                const products = this.getAll();
                const index = products.findIndex(product => product.id === id);
                if (index !== -1) {
                    products[index] = { ...products[index], ...updatedProduct };
                    StorageService.set(this.KEY, products);
                    return true;
                }
                return false;
            }

            static delete(id) {
                const products = this.getAll();
                const filteredProducts = products.filter(product => product.id !== id);
                StorageService.set(this.KEY, filteredProducts);
                return filteredProducts.length !== products.length;
            }

            static filter(searchText, category) {
                let products = this.getAll();
                
                if (searchText) {
                    const searchLower = searchText.toLowerCase();
                    products = products.filter(product => 
                        product.title.toLowerCase().includes(searchLower) || 
                        product.description.toLowerCase().includes(searchLower)
                    );
                }

                if (category) {
                    products = products.filter(product => product.category === category);
                }

                return products;
            }

            // –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ—Ä–∑–∏–Ω–æ–π
            static getCart() {
                return StorageService.get(this.CART_KEY) || [];
            }

            static addToCart(productId, quantity = 1) {
                const cart = this.getCart();
                const existingItem = cart.find(item => item.productId === productId);
                
                if (existingItem) {
                    existingItem.quantity += quantity;
                } else {
                    cart.push({ productId, quantity });
                }
                
                StorageService.set(this.CART_KEY, cart);
                return cart;
            }

            static updateCartItem(productId, quantity) {
                const cart = this.getCart();
                const item = cart.find(item => item.productId === productId);
                
                if (item) {
                    if (quantity <= 0) {
                        return this.removeFromCart(productId);
                    } else {
                        item.quantity = quantity;
                    }
                }
                
                StorageService.set(this.CART_KEY, cart);
                return cart;
            }

            static removeFromCart(productId) {
                const cart = this.getCart();
                const filteredCart = cart.filter(item => item.productId !== productId);
                StorageService.set(this.CART_KEY, filteredCart);
                return filteredCart;
            }

            static clearCart() {
                StorageService.remove(this.CART_KEY);
            }

            static getCartTotal() {
                const cart = this.getCart();
                const products = this.getAll();
                
                return cart.reduce((total, item) => {
                    const product = products.find(p => p.id === item.productId);
                    return total + (product ? product.price * item.quantity : 0);
                }, 0);
            }

            static getCartCount() {
                const cart = this.getCart();
                return cart.reduce((count, item) => count + item.quantity, 0);
            }
        }

        // –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
        class UserService {
            static KEY = 'users';
            static CURRENT_USER_KEY = 'currentUser';

            static getAll() {
                return StorageService.get(this.KEY) || [];
            }

            static getByEmail(email) {
                const users = this.getAll();
                return users.find(user => user.email === email);
            }

            static create(user) {
                const users = this.getAll();
                if (this.getByEmail(user.email)) {
                    return false;
                }
                users.push(user);
                StorageService.set(this.KEY, users);
                return true;
            }

            static login(email, password) {
                const user = this.getByEmail(email);
                if (user && user.password === password) {
                    StorageService.set(this.CURRENT_USER_KEY, user);
                    return user;
                }
                return null;
            }

            static logout() {
                StorageService.remove(this.CURRENT_USER_KEY);
            }

            static getCurrentUser() {
                return StorageService.get(this.CURRENT_USER_KEY);
            }
        }

        // –ö–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è UI
        class UI {
            static init() {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
                this.initializeData();

                // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
                this.loadProducts();

                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
                this.updateCartUI();

                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
                this.setupEventListeners();

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                this.checkAuth();
            }

            static initializeData() {
                if (!StorageService.get(UserService.KEY)) {
                    const defaultUsers = [
                        {
                            name: "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä",
                            email: "admin@example.com",
                            password: "admin123",
                            role: "admin"
                        },
                        {
                            name: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
                            email: "user@example.com",
                            password: "user123",
                            role: "user"
                        }
                    ];
                    StorageService.set(UserService.KEY, defaultUsers);
                }

                if (!StorageService.get(ProductService.KEY)) {
                    const defaultProducts = [
                        {
                            id: 1,
                            title: "–û—Ñ–∏—Å–Ω—ã–π —Å—Ç—É–ª",
                            description: "–£–¥–æ–±–Ω—ã–π —ç—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π —Å—Ç—É–ª –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –æ—Ñ–∏—Å–µ",
                            price: 4500,
                            category: "office",
                            stock: 12,
                            imageUrl: "https://images.unsplash.com/photo-1517705008128-361805f42e86?w=500&auto=format&fit=crop",
                            createdAt: new Date().toISOString()
                        },
                        {
                            id: 2,
                            title: "–ù–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞",
                            description: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è LED –ª–∞–º–ø–∞ —Å —Ä–µ–≥—É–ª–∏—Ä—É–µ–º–æ–π —è—Ä–∫–æ—Å—Ç—å—é",
                            price: 1200,
                            category: "office",
                            stock: 15,
                            imageUrl: "https://images.unsplash.com/photo-1513506003901-1e6a229e2d15?w=500&auto=format&fit=crop",
                            createdAt: new Date().toISOString()
                        },
                        {
                            id: 3,
                            title: "–ù–∞–±–æ—Ä –∫—É—Ö–æ–Ω–Ω—ã—Ö –ø–æ–ª–æ—Ç–µ–Ω–µ—Ü",
                            description: "–ù–∞–±–æ—Ä –∏–∑ 3 —Ö–ª–æ–ø–∫–æ–≤—ã—Ö –ø–æ–ª–æ—Ç–µ–Ω–µ—Ü –¥–ª—è –∫—É—Ö–Ω–∏",
                            price: 350,
                            category: "kitchen",
                            stock: 20,
                            imageUrl: "https://images.unsplash.com/photo-1604176354204-9268737828e4?w=500&auto=format&fit=crop",
                            createdAt: new Date().toISOString()
                        },
                        {
                            id: 4,
                            title: "–ë–ª–æ–∫–Ω–æ—Ç –ê5",
                            description: "–ë–ª–æ–∫–Ω–æ—Ç –≤ —Ç–≤–µ—Ä–¥–æ–π –æ–±–ª–æ–∂–∫–µ, 120 –ª–∏—Å—Ç–æ–≤",
                            price: 250,
                            category: "stationery",
                            stock: 30,
                            imageUrl: "https://images.unsplash.com/photo-1586232702178-f044c5f4d4b7?w=500&auto=format&fit=crop",
                            createdAt: new Date().toISOString()
                        },
                        {
                            id: 5,
                            title: "–ù–∞–±–æ—Ä —Ä—É—á–µ–∫",
                            description: "–ù–∞–±–æ—Ä –∏–∑ 5 –≥–µ–ª–µ–≤—ã—Ö —Ä—É—á–µ–∫ —Ä–∞–∑–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤",
                            price: 180,
                            category: "stationery",
                            stock: 25,
                            imageUrl: "https://images.unsplash.com/photo-1585336261022-680e295ce3fe?w=500&auto=format&fit=crop",
                            createdAt: new Date().toISOString()
                        },
                        {
                            id: 6,
                            title: "–î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥—É—à–∫–∞",
                            description: "–ü–æ–¥—É—à–∫–∞ –¥–ª—è –¥–∏–≤–∞–Ω–∞, —Ä–∞–∑–º–µ—Ä 40x40 —Å–º",
                            price: 800,
                            category: "home",
                            stock: 8,
                            imageUrl: "https://images.unsplash.com/photo-1579656592043-a20e25a4aa4b?w=500&auto=format&fit=crop",
                            createdAt: new Date().toISOString()
                        }
                    ];
                    StorageService.set(ProductService.KEY, defaultProducts);
                }
            }

            static loadProducts(filter = {}) {
                const products = ProductService.filter(filter.searchText, filter.category);
                this.renderProducts(products);
            }

            static renderProducts(products) {
                const productsGrid = document.getElementById('productsGrid');
                productsGrid.innerHTML = '';

                const categoryNames = {
                    'office': '–û—Ñ–∏—Å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã',
                    'home': '–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–æ–º–∞',
                    'kitchen': '–ö—É—Ö–æ–Ω–Ω—ã–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏',
                    'stationery': '–ö–∞–Ω—Ü–µ–ª—è—Ä–∏—è'
                };

                const currentUser = UserService.getCurrentUser();

                products.forEach(product => {
                    const productCard = document.createElement('div');
                    productCard.className = 'product-card';
                    
                    productCard.innerHTML = `
                        <div class="product-image" style="background-image: url('${product.imageUrl || ''}')">
                            ${product.imageUrl ? '' : '[–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ]'}
                        </div>
                        <div class="product-content">
                            <h3 class="product-title">${product.title}</h3>
                            <p>${product.description}</p>
                            <p class="product-price">${product.price.toLocaleString()} —Ä—É–±.</p>
                            <p>–í –Ω–∞–ª–∏—á–∏–∏: ${product.stock} —à—Ç.</p>
                            <span class="product-category">${categoryNames[product.category] || product.category}</span>
                            <div class="product-actions">
                                ${product.stock > 0 ? `
                                    <button class="buy-btn" data-id="${product.id}">–ö—É–ø–∏—Ç—å</button>
                                    <button class="cart-btn" data-id="${product.id}">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                                ` : '<button class="buy-btn" disabled>–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</button>'}
                                ${currentUser && currentUser.role === 'admin' ? `
                                    <div style="margin-top: 10px;">
                                        <button class="edit-btn" data-id="${product.id}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                                        <button class="delete-btn" data-id="${product.id}">–£–¥–∞–ª–∏—Ç—å</button>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    `;
                    productsGrid.appendChild(productCard);
                });
            }

            static updateCartUI() {
                const cartCount = ProductService.getCartCount();
                const cartCountElement = document.getElementById('cartCount');
                
                if (cartCount > 0) {
                    cartCountElement.textContent = cartCount;
                    cartCountElement.classList.remove('hidden');
                } else {
                    cartCountElement.classList.add('hidden');
                }
            }

            static renderCartItems() {
                const cart = ProductService.getCart();
                const products = ProductService.getAll();
                const container = document.getElementById('cartItemsContainer');
                const totalElement = document.getElementById('cartTotal');
                
                container.innerHTML = '';
                
                if (cart.length === 0) {
                    container.innerHTML = '<p>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
                    totalElement.textContent = '0';
                    return;
                }
                
                let total = 0;
                
                cart.forEach(item => {
                    const product = products.find(p => p.id === item.productId);
                    if (product) {
                        const itemTotal = product.price * item.quantity;
                        total += itemTotal;
                        
                        const cartItem = document.createElement('div');
                        cartItem.className = 'cart-item';
                        cartItem.innerHTML = `
                            <img src="${product.imageUrl || ''}" alt="${product.title}">
                            <div class="cart-item-info">
                                <h4>${product.title}</h4>
                                <p>${product.price.toLocaleString()} —Ä—É–±. √ó ${item.quantity} = ${itemTotal.toLocaleString()} —Ä—É–±.</p>
                            </div>
                            <div class="cart-item-actions">
                                <div class="quantity-control">
                                    <button class="decrease-btn" data-id="${product.id}">-</button>
                                    <input type="number" value="${item.quantity}" min="1" max="${product.stock}" data-id="${product.id}">
                                    <button class="increase-btn" data-id="${product.id}" ${item.quantity >= product.stock ? 'disabled' : ''}>+</button>
                                </div>
                                <button class="delete-btn" data-id="${product.id}">–£–¥–∞–ª–∏—Ç—å</button>
                            </div>
                        `;
                        container.appendChild(cartItem);
                    }
                });
                
                totalElement.textContent = total.toLocaleString();
            }

            static setupEventListeners() {
                // –ö–Ω–æ–ø–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                document.getElementById('loginBtn').addEventListener('click', () => this.openModal('loginModal'));
                document.getElementById('registerBtn').addEventListener('click', () => this.openModal('registerModal'));
                document.getElementById('logoutBtn').addEventListener('click', this.logout.bind(this));

                // –ö–Ω–æ–ø–∫–∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
                document.getElementById('cancelLoginBtn').addEventListener('click', () => this.closeModal('loginModal'));
                document.getElementById('cancelRegisterBtn').addEventListener('click', () => this.closeModal('registerModal'));
                document.getElementById('cancelProductBtn').addEventListener('click', () => this.closeModal('productModal'));

                // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ñ–æ—Ä–º
                document.getElementById('confirmLoginBtn').addEventListener('click', this.login.bind(this));
                document.getElementById('confirmRegisterBtn').addEventListener('click', this.register.bind(this));
                document.getElementById('saveProductBtn').addEventListener('click', this.saveProduct.bind(this));

                // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
                document.getElementById('addProductBtn').addEventListener('click', () => {
                    this.editingProductId = null;
                    this.openProductModal();
                });

                // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤
                document.getElementById('applyFilterBtn').addEventListener('click', () => {
                    const searchText = document.getElementById('searchInput').value;
                    const category = document.getElementById('categoryFilter').value;
                    this.loadProducts({ searchText, category });
                });

                // –í–∫–ª–∞–¥–∫–∏ –≤ —Ñ–æ—Ä–º–µ —Ç–æ–≤–∞—Ä–∞
                document.querySelectorAll('.tab-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const tabId = button.getAttribute('data-tab');
                        this.switchTab(tabId);
                    });
                });

                // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                document.getElementById('previewImageBtn').addEventListener('click', this.previewImage.bind(this));
                document.getElementById('productImage').addEventListener('change', this.previewUploadedImage.bind(this));

                // –ö–æ—Ä–∑–∏–Ω–∞
                document.getElementById('cartIcon').addEventListener('click', () => {
                    this.renderCartItems();
                    this.openModal('cartModal');
                });
                document.getElementById('checkoutBtn').addEventListener('click', this.checkout.bind(this));

                // –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫
                document.getElementById('productsGrid').addEventListener('click', event => {
                    if (event.target.classList.contains('buy-btn')) {
                        const productId = parseInt(event.target.getAttribute('data-id'));
                        this.buyProduct(productId);
                    } else if (event.target.classList.contains('cart-btn')) {
                        const productId = parseInt(event.target.getAttribute('data-id'));
                        this.addToCart(productId);
                    } else if (event.target.classList.contains('edit-btn')) {
                        const productId = parseInt(event.target.getAttribute('data-id'));
                        this.editProduct(productId);
                    } else if (event.target.classList.contains('delete-btn')) {
                        const productId = parseInt(event.target.getAttribute('data-id'));
                        this.deleteProduct(productId);
                    }
                });

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã
                document.getElementById('cartItemsContainer').addEventListener('click', event => {
                    if (event.target.classList.contains('decrease-btn')) {
                        const productId = parseInt(event.target.getAttribute('data-id'));
                        const input = event.target.nextElementSibling;
                        const newQuantity = parseInt(input.value) - 1;
                        this.updateCartItem(productId, newQuantity);
                    } else if (event.target.classList.contains('increase-btn')) {
                        const productId = parseInt(event.target.getAttribute('data-id'));
                        const input = event.target.previousElementSibling;
                        const newQuantity = parseInt(input.value) + 1;
                        this.updateCartItem(productId, newQuantity);
                    } else if (event.target.classList.contains('delete-btn')) {
                        const productId = parseInt(event.target.getAttribute('data-id'));
                        this.removeFromCart(productId);
                    }
                });

                document.getElementById('cartItemsContainer').addEventListener('change', event => {
                    if (event.target.tagName === 'INPUT' && event.target.type === 'number') {
                        const productId = parseInt(event.target.getAttribute('data-id'));
                        const newQuantity = parseInt(event.target.value);
                        this.updateCartItem(productId, newQuantity);
                    }
                });
            }

            static switchTab(tabId) {
                // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                document.querySelectorAll('.tab-button').forEach(button => {
                    button.classList.remove('active');
                });
                
                // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
                document.getElementById(tabId).classList.add('active');
                
                // –°–¥–µ–ª–∞—Ç—å –∫–Ω–æ–ø–∫—É –∞–∫—Ç–∏–≤–Ω–æ–π
                event.currentTarget.classList.add('active');
            }

            static previewImage() {
                const url = document.getElementById('imageUrl').value;
                if (url) {
                    const imgPreview = document.getElementById('urlImagePreview');
                    imgPreview.src = url;
                    imgPreview.style.display = 'block';
                    imgPreview.onerror = () => {
                        alert('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É URL');
                        imgPreview.style.display = 'none';
                    };
                    this.currentImageUrl = url;
                }
            }

            static previewUploadedImage(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = e => {
                        document.getElementById('uploadImagePreview').src = e.target.result;
                        document.getElementById('uploadImagePreview').style.display = 'block';
                        this.currentImageUrl = e.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            }

            static openModal(modalId) {
                document.getElementById(modalId).style.display = 'flex';
                // –û—á–∏—Å—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
                document.querySelectorAll(`#${modalId} .error-message`).forEach(el => {
                    el.textContent = '';
                });
            }

            static closeModal(modalId) {
                document.getElementById(modalId).style.display = 'none';
                // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π
                if (modalId === 'productModal') {
                    this.resetProductForm();
                }
            }

            static openProductModal(productId = null) {
                const modal = document.getElementById('productModal');
                const title = document.getElementById('productModalTitle');
                
                if (productId) {
                    title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä';
                    const product = ProductService.getById(productId);
                    if (product) {
                        document.getElementById('productTitle').value = product.title;
                        document.getElementById('productDescription').value = product.description;
                        document.getElementById('productPrice').value = product.price;
                        document.getElementById('productCategory').value = product.category;
                        document.getElementById('productStock').value = product.stock;
                        document.getElementById('imageUrl').value = product.imageUrl || '';
                        
                        if (product.imageUrl) {
                            document.getElementById('urlImagePreview').src = product.imageUrl;
                            document.getElementById('urlImagePreview').style.display = 'block';
                            this.currentImageUrl = product.imageUrl;
                            this.switchTab('urlTab');
                        } else {
                            document.getElementById('urlImagePreview').style.display = 'none';
                            document.getElementById('uploadImagePreview').style.display = 'none';
                        }
                        
                        this.editingProductId = productId;
                    }
                } else {
                    title.textContent = '–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä';
                    this.resetProductForm();
                    this.editingProductId = null;
                }
                
                this.openModal('productModal');
            }

            static resetProductForm() {
                document.getElementById('productTitle').value = '';
                document.getElementById('productDescription').value = '';
                document.getElementById('productPrice').value = '';
                document.getElementById('productCategory').value = 'office';
                document.getElementById('productStock').value = '';
                document.getElementById('imageUrl').value = '';
                document.getElementById('urlImagePreview').style.display = 'none';
                document.getElementById('uploadImagePreview').style.display = 'none';
                document.getElementById('productImage').value = '';
                this.currentImageUrl = '';
                this.switchTab('urlTab');
            }

            static checkAuth() {
                const currentUser = UserService.getCurrentUser();
                if (currentUser) {
                    this.updateAuthUI(currentUser);
                }
            }

            static updateAuthUI(user) {
                const authButtons = document.querySelector('.auth-buttons');
                const adminPanel = document.getElementById('adminPanel');
                const addProductBtn = document.getElementById('addProductBtn');
                const userGreeting = document.getElementById('userGreeting');
                const userName = document.getElementById('userName');

                if (user) {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
                    userGreeting.classList.remove('hidden');
                    userName.textContent = user.name || user.email;
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤—ã—Ö–æ–¥–∞ –∏ —Å–∫—Ä—ã–≤–∞–µ–º –≤—Ö–æ–¥/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
                    document.getElementById('loginBtn').classList.add('hidden');
                    document.getElementById('registerBtn').classList.add('hidden');
                    document.getElementById('logoutBtn').classList.remove('hidden');

                    // –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –∏ –∫–Ω–æ–ø–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
                    if (user.role === 'admin') {
                        adminPanel.style.display = 'block';
                        addProductBtn.classList.remove('hidden');
                    } else {
                        adminPanel.style.display = 'none';
                        addProductBtn.classList.add('hidden');
                    }
                } else {
                    // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
                    userGreeting.classList.add('hidden');
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–∫—Ä—ã–≤–∞–µ–º –≤—ã—Ö–æ–¥
                    document.getElementById('loginBtn').classList.remove('hidden');
                    document.getElementById('registerBtn').classList.remove('hidden');
                    document.getElementById('logoutBtn').classList.add('hidden');

                    // –°–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ –∫–Ω–æ–ø–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
                    adminPanel.style.display = 'none';
                    addProductBtn.classList.add('hidden');
                }
            }

            static validateForm(formId) {
                let isValid = true;
                const form = document.getElementById(formId);
                
                // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –æ—à–∏–±–æ–∫
                form.querySelectorAll('.error-message').forEach(el => {
                    el.textContent = '';
                });

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
                form.querySelectorAll('[required]').forEach(input => {
                    if (!input.value.trim()) {
                        const errorId = `${input.id}Error`;
                        const errorElement = document.getElementById(errorId);
                        if (errorElement) {
                            errorElement.textContent = '–≠—Ç–æ –ø–æ–ª–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è';
                        }
                        isValid = false;
                    }
                });

                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                if (formId === 'registerModal') {
                    const password = document.getElementById('regPassword').value;
                    const confirmPassword = document.getElementById('regConfirmPassword').value;
                    
                    if (password !== confirmPassword) {
                        document.getElementById('regConfirmPasswordError').textContent = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
                        isValid = false;
                    }
                }

                return isValid;
            }

            static login() {
                if (!this.validateForm('loginModal')) return;

                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;

                const user = UserService.login(email, password);
                if (user) {
                    this.closeModal('loginModal');
                    this.updateAuthUI(user);
                    this.loadProducts();
                } else {
                    document.getElementById('loginPasswordError').textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å';
                }
            }

            static register() {
                if (!this.validateForm('registerModal')) return;

                const name = document.getElementById('regName').value;
                const email = document.getElementById('regEmail').value;
                const password = document.getElementById('regPassword').value;
                const role = document.getElementById('regRole').value;

                const newUser = {
                    name,
                    email,
                    password,
                    role
                };

                if (UserService.create(newUser)) {
                    UserService.login(email, password);
                    this.closeModal('registerModal');
                    this.updateAuthUI(newUser);
                    this.loadProducts();
                } else {
                    document.getElementById('regEmailError').textContent = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç';
                }
            }

            static logout() {
                UserService.logout();
                this.updateAuthUI(null);
                this.loadProducts();
            }

            static saveProduct() {
                if (!this.validateForm('productModal')) return;

                const title = document.getElementById('productTitle').value;
                const description = document.getElementById('productDescription').value;
                const price = parseFloat(document.getElementById('productPrice').value);
                const category = document.getElementById('productCategory').value;
                const stock = parseInt(document.getElementById('productStock').value);
                const imageUrl = this.currentImageUrl;
                const currentUser = UserService.getCurrentUser();

                if (!currentUser || currentUser.role !== 'admin') {
                    alert('–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–≤–∞—Ä—ã');
                    return;
                }

                const productData = {
                    title,
                    description,
                    price,
                    category,
                    stock,
                    imageUrl,
                    createdAt: new Date().toISOString()
                };

                if (this.editingProductId) {
                    if (ProductService.update(this.editingProductId, productData)) {
                        this.closeModal('productModal');
                        this.loadProducts();
                    }
                } else {
                    ProductService.create(productData);
                    this.closeModal('productModal');
                    this.loadProducts();
                }
            }

            static editProduct(productId) {
                const currentUser = UserService.getCurrentUser();

                if (!currentUser || currentUser.role !== 'admin') {
                    alert('–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã');
                    return;
                }

                this.editingProductId = productId;
                this.openProductModal(productId);
            }

            static deleteProduct(productId) {
                const currentUser = UserService.getCurrentUser();

                if (!currentUser || currentUser.role !== 'admin') {
                    alert('–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å —Ç–æ–≤–∞—Ä—ã');
                    return;
                }

                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')) {
                    ProductService.delete(productId);
                    this.loadProducts();
                }
            }

            static buyProduct(productId) {
                const product = ProductService.getById(productId);
                if (!product) return;

                if (product.stock <= 0) {
                    alert('–≠—Ç–æ—Ç —Ç–æ–≤–∞—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è');
                    return;
                }

                if (confirm(`–í—ã —Ö–æ—Ç–∏—Ç–µ –∫—É–ø–∏—Ç—å "${product.title}" –∑–∞ ${product.price} —Ä—É–±.?`)) {
                    alert('–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É! –¢–æ–≤–∞—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.');
                    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –ª–æ–≥–∏–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
                }
            }

            static addToCart(productId) {
                const product = ProductService.getById(productId);
                if (!product) return;

                if (product.stock <= 0) {
                    alert('–≠—Ç–æ—Ç —Ç–æ–≤–∞—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è');
                    return;
                }

                ProductService.addToCart(productId);
                this.updateCartUI();
                alert('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É');
            }

            static updateCartItem(productId, quantity) {
                ProductService.updateCartItem(productId, quantity);
                this.renderCartItems();
                this.updateCartUI();
            }

            static removeFromCart(productId) {
                ProductService.removeFromCart(productId);
                this.renderCartItems();
                this.updateCartUI();
            }

            static checkout() {
                const cart = ProductService.getCart();
                if (cart.length === 0) {
                    alert('–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞');
                    return;
                }

                const currentUser = UserService.getCurrentUser();
                if (!currentUser) {
                    alert('–î–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è');
                    this.closeModal('cartModal');
                    this.openModal('loginModal');
                    return;
                }

                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –ª–æ–≥–∏–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
                alert('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É.');
                ProductService.clearCart();
                this.closeModal('cartModal');
                this.updateCartUI();
                this.loadProducts(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ (–º–æ–≥–ª–æ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', () => UI.init());
    </script>
</body>
</html>